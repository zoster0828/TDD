# 피트니스 함수
* 피트니스 함수는 솔루션이 얼마나 이상적인 목표에 접근했는지 평가할 수 있는 도구가 된다
## 2.1 정의
* 아키텍처 피트니스 함수는 아키텍처 특성에 대해 객관적인 무결성 평가를 내릴 수 있는 모든 메커니즘을 일컫는다
> 과거 기업들은 SQE와 같은 조직을 두어 개발팀 외부에서 시스템의 진화 관리를 일임해 왔다
> 
> 데브옵스의 발전에 따라 SQE는 개발팀 외부에 존재하기 때문에 각종 개발팀 테스트로 대체되었으나
> 
> 과도기에는 SQE의 부재와 개발팀 테스트의 미흡함이 맞물려 이슈가 발생하고 SQE 조직의 필요성이 다시 대두되기도 했음

* 단위 테스트가 도메인을, 피트니스 함수는 아키텍처 특성을 보호한다.
* 피트니스 함수는 반드시 코드여야 하는 것은 아니며 다양한 방식으로 구현할 수 있다
* 성능, 코딩 표준등의 목표를 측정하는 도구로 사용할 수 있다
  * 중요한 것은 모든것을 측정하는 것이 아니라 아키텍트가 중요하다고 판단한 거버넌스 요소의 성능을 측정하는 것이다
* 피트니스 함수에 의해 진화적 아키텍처가 유도된다
  * 피트니스 함수는 아키텍처에서 중요한 것이 무엇인가에 대한 정의의며 S/W 시스템 개발 과정에서 발생하는 트레이드오프를 판가름 하는 기준이다
* 기존에 존재하던 임계값과 요구사항을 피트니스 함수로 한데 모으면 모호하고 주관적이었던 평가 기준을 구체적으로 표현할 수 있다
> 아키텍처의 특성을 OKR로 표현하여 수치화 해둔 패널이 있다면
> 
> 해당 패널의 임계값을 초과하는 방향은 시스템이 잘못 나아가는 방향이라고 볼 수 있을까?


## 2.2 범주
### 2.2.1 스코프 : 원자 VS 전체
* 원자 : 컴포넌트의 순환 의존성을 확인하는 UNIT TEST
* 전체 : 보안, 확장성에 모두 피트니스 함수를 보유 했다면, caching 구현을 통해 확장성을 통과하더라도 보안을 통과할 수 없다. caching을 끄고 보안을 통과할 수 있지만 전체 피트니스 함수는
통과할 수 없게 된다
  * 이러한 조합을 일일이 테스트할 수 없기 때문에 중요한 상호작용을 선별하고 조합해 전체 피트니스 함수를 만들어야 한다
### 2.2.2 케이던스 : 트리거 vs 지속 vs 시간
* 트리거 : unit / acceptance / scenario 와 같이 이벤트를 기반으로 수행
* 지속 : 모니터링 도구를 이용한 알림과 같은 지속적으로 감시 또는 수행
* 시간 : 암호화 라이브러리 추가와 같이 일정 시간 이후에 확인할 수 있는 경우

### 2.2.4 결과 : 정적 vs 동적
* 정적 : 통과 / 실패와 같이 고정적인 결과 리턴
* 동적 : 평가의 근거가 동적으로 변하는 경우, 다만 객관적인 결과로 평가되어야 함

### 2.2.5 호출 : 자동 vs 수동
* 자동 : CI / CD에서 피트니스 함수를 수행, 개입없이 자동으로 수행됨
* 수동 : 자동화에 저항하는 경우, 법적 요건과 같이 시스템화 할 수 없는 경우

### 2.2.6 선제적 : 의도 VS 긴급
* 의도 : 프로젝트 시작 단계에서 의도한다
* 긴급 : 거버넌스를 개선할 수 있는 행동을 발견했을때 만들어진다
* 어느쪽이든 아키텍처의 요구사항이 변경되고 발전함에 따라 함께 적절하게 변경될 필요가 있다

### 2.2.7 커버리지 : 도메인별 피트니스 함수
* 도메인 테스트와 피트니스 함수는 구분하는 것이 좋다
  * 피트니스 함수는 아키텍처의 문제를 검증하기 위한 도구로 사용하는 것이 중복을 피하는 방법이다

## 2.3 피트니스 함수는 누가 작성하는가
* 아키텍트는 개발자와 협업하며 피트니스 함수의 목적과 활용 방안을 정의하고 함께 이해해야 한다
  * 변경 사항이 거버넌스 규정을 위반하면 검증 계층에서 차단되고, 이는 긍정적인 실패다
  * 그러나 개발자가 피트니스 함수의 목적을 이해하지 못한다면 기능을 보호하는 제약이 아닌 그저 걸림돌로 여기게 된다

> 몇가지 피트니스 함수라고 부를만한 것이 회사에도 있는것 같은데, 개발자와 협업되지 않고 정의되어 있다
> 
> 이러한 도구들은 마치 걸림돌처럼 보이지만 무시하고 지나가기엔 찝찝하거나 강한 제약조건으로 작용하고 있다
> 
> 개발자와 협업하여 만들어졌다면 기능을 보호하는 제약으로 느낄 수 있을 것 같다

## 2.4 피트니스 함수 테스트 프레임워크 선택
* 완벽하게 도메인에 FIT 한 함수는 없지만, 약간의 접착제를 활용하면 쓸 만한 피트니스 함수를 구성할 수 있다

## 2.5 결과 VS 구현
* 함수가 가진 함의는 입력에 대해 부작용 없는 출력을 생성한다는 것이다
  * 피트니스 함수는 아키텍처 특성에 대한 객관적인 평가를 도출하는 도구이기 때문에
  * 측정기법, 구현보다는 이유와 결과에 집중하는 것이 좋다

* 원하는 방향으로 아키텍처가 진화하도록 유도하기 위해 여러 측면에 제약을 두고 잘못된 방향의 진화를 억제한다
* 이러한 피트니스 함수들을 한데 모아 **시스템 피트니스 함수**라는 개념을 부여할 수 있다
* 시스템 피트니스 함수는 트레이드오프가 발생했을때 각각의 피트니스 함수를 이용해 우선순위를 정하기 위한 지침으로 사용할 수 있다   
