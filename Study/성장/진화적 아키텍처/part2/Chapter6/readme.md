# 진화적 데이터
## 6.1 진화적 데이터베이스 설계
* 진화적 데이터베이스 설계란 요구 사항의 변화에 따라 발전하는 구축하는 것
* 개발자와 데이터팀은 데이터베이스 설계를 통해 실제 세계를 추상화한다
* 따라서 실제 세계의 변화는 반드시 이 추상화에 반영되어야 한다

### 6.1.1 진화적 스키마
* 진화적 데이터베이스 설계의 핵심은 진화하는 스키마이다
* 개발자는 데이터베이스 변경사항을 소스코드처럼 테스트하고 버저닝하고 증분 형태로 관리해야 한다

**테스트**
* 데이터베이스 스키마의 변경사항을 엄격하게 테스트해야 한다
* ORM을 사용한다면 매핑 코드와 스키마를 항상 동기화 시켜야 한다

**버전 관리**
* 개발자와 데이터팀은 데이터베이스 스키마와 관련 코드에 버전을 지정해야 한다

**증분 변경**
* 소스의 변경이 기록으로 쌓이듯 데이터베이스 스키마의 변경 사항도 증분 방식으로 기록해야 한다

### 6.1.2 공유 데이터베이스 통합
* 일반적으로 사용되는 공유 데이터베이스 통합 패턴은 데이터베이스를 공유 메커니즘으로 사용하는 통합 패턴이다
* 그러나 데이터베이스를 통합 지점으로 활용하면 이를 공유하는 모든 프로젝트에서 스키마가 고착화될 우려가 있다
* A가 스키마를 변경하면 다른 두 어플리케이션에서도 잠재적인 장애의 위험에 처한다

**how to solve this problem?**
* 확장/수축 패턴
> 우리는 흔히 2 step 배포라고 부름

* 이전 상태와 변경 상태를 동시에 유지한다
```JAVA
class A{
    String name; // legacy
    String firstName; // new
    String lastName; // new
    public A(String name) { // legacy
        firstName = extractFirst(name);
        lastName = extractLast(name);
        name = name;
    }
    
    public A(String firstName, String lastName) { // new
        firstName = firstName;
        lastName = lastName;
        name = firstName + " " + lastName;
    }
}
```
* 전환 기간 동안 이전 버전과의 호환성을 보장하고 다른 부분들이 변경할 수 있는 여유가 생긴다
> 통합 기간이 무한히 길어질 수 있지 않을까?

## 6.2 부적절한 데이터 얽힘
### 6.2.1 2단계 커밋 트랜잭션


